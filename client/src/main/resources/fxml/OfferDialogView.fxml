<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Text?>

<DialogPane prefHeight="600.0" prefWidth="700.0" styleClass="offer-dialog" 
           stylesheets="@../css/styles.css"
           xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1" 
           fx:controller="com.uninaswap.client.controller.OfferDialogController">
   
   <content>
      <VBox spacing="20.0" styleClass="offer-content">
         <padding>
            <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
         </padding>
         
         <!-- Listing Information -->
         <VBox spacing="10.0" styleClass="listing-info-section">
            <children>
               <Text styleClass="section-title" text="Offerta per:" />
               <HBox alignment="CENTER_LEFT" spacing="15.0">
                  <children>
                     <ImageView fx:id="listingImage" fitHeight="60.0" fitWidth="60.0" 
                               preserveRatio="true" styleClass="listing-thumbnail" />
                     <VBox spacing="3.0">
                        <children>
                           <Text fx:id="listingTitle" styleClass="listing-title" text="Listing Title" />
                           <Text fx:id="listingPrice" styleClass="listing-price" text="€ 25.00" />
                        </children>
                     </VBox>
                  </children>
               </HBox>
            </children>
         </VBox>
         
         <Separator />
         
         <!-- Money Offer Section -->
         <VBox fx:id="moneyOfferSection" spacing="15.0" styleClass="money-offer-section">
            <children>
               <CheckBox fx:id="includeMoneyCheckBox" styleClass="section-checkbox" text="Includi offerta monetaria" />
               
               <VBox fx:id="moneyInputSection" spacing="10.0" visible="false">
                  <children>
                     <HBox alignment="CENTER_LEFT" spacing="10.0">
                        <children>
                           <Label text="Importo:" />
                           <TextField fx:id="moneyAmountField" prefWidth="150.0" promptText="0.00" />
                           <ComboBox fx:id="currencyComboBox" prefWidth="80.0" />
                        </children>
                     </HBox>
                     <Label fx:id="priceConstraintLabel" styleClass="constraint-label" 
                           text="Deve essere inferiore al prezzo richiesto" />
                  </children>
               </VBox>
            </children>
         </VBox>
         
         <!-- Items Offer Section (Trade Listings Only) -->
         <VBox fx:id="itemsOfferSection" spacing="15.0" styleClass="items-offer-section" visible="false">
            <children>
               <Text styleClass="section-title" text="Oggetti da offrire" />
               
               <!-- Available Items Table -->
               <VBox spacing="10.0">
                  <children>
                     <HBox alignment="CENTER_LEFT" spacing="10.0">
                        <children>
                           <Label text="Seleziona dai tuoi oggetti:" />
                           <Region HBox.hgrow="ALWAYS" />
                           <Button fx:id="addNewItemButton" onAction="#handleAddNewItem" 
                                  styleClass="add-item-button" text="+ Aggiungi nuovo oggetto" />
                        </children>
                     </HBox>
                     
                     <TableView fx:id="availableItemsTable" prefHeight="200.0">
                        <columns>
                           <TableColumn fx:id="itemNameColumn" prefWidth="150.0" text="Nome" />
                           <TableColumn fx:id="itemConditionColumn" prefWidth="100.0" text="Condizione" />
                           <TableColumn fx:id="itemAvailableColumn" prefWidth="80.0" text="Disponibili" />
                           <TableColumn fx:id="itemQuantityColumn" prefWidth="80.0" text="Quantità" />
                           <TableColumn fx:id="itemActionColumn" prefWidth="80.0" text="Azione" />
                        </columns>
                     </TableView>
                  </children>
               </VBox>
               
               <Separator />
               
               <!-- Selected Items for Offer -->
               <VBox spacing="10.0">
                  <children>
                     <Text styleClass="subsection-title" text="Oggetti selezionati per l'offerta:" />
                     <TableView fx:id="selectedItemsTable" prefHeight="150.0">
                        <columns>
                           <TableColumn fx:id="selectedNameColumn" prefWidth="150.0" text="Nome" />
                           <TableColumn fx:id="selectedConditionColumn" prefWidth="100.0" text="Condizione" />
                           <TableColumn fx:id="selectedQuantityColumn" prefWidth="80.0" text="Quantità" />
                           <TableColumn fx:id="selectedRemoveColumn" prefWidth="80.0" text="Rimuovi" />
                        </columns>
                     </TableView>
                  </children>
               </VBox>
            </children>
         </VBox>
         
         <!-- Message Section -->
         <VBox spacing="10.0" styleClass="message-section">
            <children>
               <Label text="Messaggio (opzionale):" />
               <TextArea fx:id="messageArea" prefRowCount="3" promptText="Aggiungi un messaggio per il venditore..." wrapText="true" />
            </children>
         </VBox>
         
         <!-- Offer Summary -->
         <VBox spacing="10.0" styleClass="offer-summary">
            <children>
               <Text styleClass="section-title" text="Riepilogo offerta" />
               <VBox fx:id="offerSummaryContent" spacing="5.0" styleClass="summary-content" />
            </children>
         </VBox>
      </VBox>
   </content>
</DialogPane>